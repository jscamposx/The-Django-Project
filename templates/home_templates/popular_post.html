{% block body%}{% load static %}

<div class="img-thumbnail post_body w-100 d-flex flex-column justify-content-between" style="margin: 15px; box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.449);">
        <div class="caption flex-grow-1 d-flex flex-column">
            <div style="position: relative; flex-grow: 1; overflow: hidden; overflow-wrap: break-word;">

                <a href="{{ post.get_absolute_url }}" ><span class="div_link" ></span></a>

                {% if post.image %}
                    <img src="{{ post.image.url }}" alt="Post Image" class="img-thumbnail" style="max-height: 100px;">
                {% endif %}

                <h3 class="post_title">
                    {{ post.title }}
                </h3>
                <h6 class="post_title">
                    Yazar: {{ post.user.username }}
                </h6>
                <hr>
                <p>{{ post.desc|safe|linebreaks|truncatechars:150 }}</p>

            </div>
            
            <div class="mt-auto">
                <hr>

                {% if request.user.is_authenticated %}

                    {% if post.id in upvoted_posts %}
                        <a href="/{{post.id}}/upvote" role="button"><img class="scale-hover" src="{% static 'img/upvote_fill.png' %}" alt=""></a>{{post.upvotes}} |
                    {% else %}
                        <a href="/{{post.id}}/upvote" role="button"><img class="scale-hover" src="{% static 'img/upvote.svg' %}" alt=""></a>{{post.upvotes}} |
                    {% endif %}

                    <img src="{% static '/img/eye.svg' %}" alt="">{{ post.post_views }} |

                    {% if post.user == request.user %}
                        <a href="{{ post.get_update_url }}" class="btn btn-primary button_shadow" role="button">Update</a>
                        <button type="button" class="btn btn-danger button_shadow" data-bs-toggle="modal" data-bs-target="#modal_{{ post.id }}">Delete</button>
                    {% endif %}
                    <small data-toggle="tooltip" data-placement="top" title="{{post.date}}" >{{post.date|timesince}} Ago</small>
                {% endif %}
            </div>
    </div>
</div>

<!-- Modal post delete -->
<div class="modal fade" id="modal_{{ post.id }}" tabindex="-1" aria-labelledby="modalLabel_{{ post.id }}" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalLabel_{{ post.id }}">Delete Post</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                Are you sure you want to delete this post?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary button_shadow" data-bs-dismiss="modal">No</button>
                {% if request.user.is_authenticated %}
                    <a href="{{ post.get_delete_url_home }}" class="btn btn-danger button_shadow" role="button">Delete</a>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock%}
